Below is a detailed description of the algorithm applied to extract the key fiducial points from each heartbeat:

1) R peak annotations from each recordâ€™s .atr file are used to identify each heartbeat. The algorithm selects a 640 ms segment (373 ms preceding and 267 ms following the annotated R peak) of the signal for analyzing each heartbeat.

2) Initially, ğ‘„ğ‘ğ‘’ğ‘ğ‘˜, ğ‘…ğ‘ğ‘’ğ‘ğ‘˜, ğ‘†ğ‘ğ‘’ğ‘ğ‘˜, and ğ‘ƒğ‘ğ‘’ğ‘ğ‘˜ are assumed to be zero, indicating the absence of corresponding waves.

3) If ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥ (the maximum signal value within 100 ms around the annotation) is positive, ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ is set to ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.

4) Look backward from ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥ and evaluate the signal and its inflection points in the following way:
    a. Set ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥/2ğ‘ equal to the first location where the signal goes below half of ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.    
b. Set ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥/4ğ‘ equal to the first location where the signal goes below a quarter of ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.
c. If the first inflection point is negative and ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ is not zero, then ğ‘„ğ‘ğ‘’ğ‘ğ‘˜ is set equal to the value at such point.
d. If the first inflection point is >= zero and ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ is not zero, then it is set as ğ‘„ğ‘…ğ‘†ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡ and ğ‘„ğ‘ğ‘’ğ‘ğ‘˜ is considered zero.
e. If the first inflection point is positive and ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ is zero, then set ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ equal to the value at such point and set ğ‘†ğ‘ğ‘’ğ‘ğ‘˜ equal to ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.
f. If the second inflection point is negative, ğ‘„ğ‘ğ‘’ğ‘ğ‘˜ is zero, and ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥ is positive, then set ğ‘„ğ‘ğ‘’ğ‘ğ‘˜ equal to the value at such point.
g. If ğ‘„ğ‘ğ‘’ğ‘ğ‘˜ is not zero and the signal crosses zero, then the first non-negative point is set as ğ‘„ğ‘…ğ‘†ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡.
h. If the second inflection point is >= zero and ğ‘„ğ‘…ğ‘†ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡ has not been found yet, then it is set as ğ‘„ğ‘…ğ‘†ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡.

5) Look forward from ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥ and evaluate the signal and its inflection points in the following way:
a. Set ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥/2ğ‘ equal to the first location where the signal goes below half of ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.
b. Set ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥/4ğ‘ equal to the first location where the signal goes below a quarter of ğ‘„ğ‘…ğ‘†ğ‘šğ‘ğ‘¥.
c. If the first inflection point is negative and ğ‘…ğ‘ğ‘’ğ‘ğ‘˜ is not zero, then set ğ‘†ğ‘ğ‘’ğ‘ğ‘˜ equal to the value at such point.
d. If ğ‘†ğ‘ğ‘’ğ‘ğ‘˜ is not zero and the signal cross zero, then the first non-negative point is marked as ğ‘„ğ‘…ğ‘†ğ‘’ğ‘›ğ‘‘.
e. If the second inflection point is >= zero and ğ‘„ğ‘…ğ‘†ğ‘’ğ‘›ğ‘‘ has not been found yet, then it is set as ğ‘„ğ‘…ğ‘†ğ‘’ğ‘›ğ‘‘.

6) Find the maximum value of the signal in the segment that goes between 233 ms and 67 ms before ğ‘„ğ‘…ğ‘†ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡. If such value is greater than three times the standard deviation of the signal during the 67 ms preceding the current segment and it is located at an inflection point in the signal, then set it equal to ğ‘ƒğ‘ğ‘’ğ‘ğ‘˜.

After pinpointing the fiducial points, calculating all the features becomes straightforward by assessing the differences in values or positions of these corresponding fiducial points.
